rules_version = '2';

// Firebase Storage Security Rules for Bonnie Lass Florals
// 
// This file defines access control rules for Firebase Storage buckets.
// These rules control who can read and write files in Firebase Storage.
//
// Deployment Instructions:
// 1. Firebase Console: Storage > Rules > Copy and Paste > Publish
// 2. Firebase CLI: firebase deploy --only storage
//
// For detailed documentation and admin-only alternatives, see:
// docs/implementation/STORAGE_RULES.md

service firebase.storage {
  match /b/{bucket}/o {
    
    // Product images - public read, authenticated write
    // Path: /product-images/*
    // Fix: Allow authenticated users to upload product images
    match /product-images/{imageName} {
      // Allow all users to read/view product images (required for public website)
      allow read: if true;
      
      // Allow authenticated users to upload/update/delete product images
      // This prevents unauthenticated uploads and protects against abuse
      // For admin-only uploads, see docs/implementation/STORAGE_RULES.md
      allow write: if request.auth != null
                  && request.resource.size < 10 * 1024 * 1024  // Max 10MB
                  && request.resource.contentType.matches('image/.*');  // Only image types
    }
    
    // Default rule - deny all access to other paths
    // This ensures only explicitly allowed paths are accessible
    match /{allPaths=**} {
      allow read, write: if false;
    }
  }
}
